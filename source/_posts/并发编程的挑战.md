---
title: 一、并发编程的挑战 - Note
categories: 技术
tags:
  - 笔记
  - 并发
  - 多线程
  - 《Java并发编程的艺术》
date: 2018-01-11 23:12:44
---


### 概述
并发编程的目的是为了让程序运行的更快，但是，并不是启动更多的线程就能让程序最大限度的并发执行。如果希望通过多线程执行任务让程序运行的更快，会面临很多挑战。

### 挑战一：上下文切换
- 即使是单核处理器也支持多线程。CPU通过给每个线程分配`时间片`，因为`时间片`非常短（一般为几十毫秒），所以CPU通过不断地切换线程执行，使我们感觉多个线程是同时执行的。
- 在切换前会保存上一个任务的状态，以便下次切换回这个任务时，再加载这个任务的状态。任务从保存到再加载的过程就是一次`上下文切换`。`上下文切换`会影响多线程的执行速度。  
- ** 多线程一定快吗？ **  
通过代码测试发现，上述问题的答案是：**不一定**。当并发执行的次数很多，达到百万、千万级别时，才会相对较快。

### 挑战二：死锁

<!--more-->

- `锁`是一个非常有用的工具，运用场景非常多，因为它使用起来非常简单，而且易于理解。但同时它也会带来一些困扰，比如可能会引起`死锁`，一旦产生`死锁`，就会造成系统功能不可用。
- 避免死锁的几个常见方法：
  - 避免一个线程同时获得多个锁。
  - 避免一个线程在锁内同时占用多个资源，尽量保证每个锁只占用一个资源。
  - 尝试使用定时锁，使用`lock.tryLock(timeout)`来代替使用内部锁机制。
  - 对于数据库锁，加锁和解锁必须在一个数据库连接里，否则会出现解锁失败的情况。

### 挑战三：资源限制的挑战


> 参考
> * 方鹏飞 - 《Java并发编程的艺术》
